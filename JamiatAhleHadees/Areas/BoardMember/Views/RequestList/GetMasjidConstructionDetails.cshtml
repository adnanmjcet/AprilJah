@model CommonLayer.CommonModels.MasjidConstructionRequestModel

@{
    ViewBag.Title = "GetMasjidConstructionDetails";
}


<div>
    <h4>Masjid Construction Request</h4>
    <hr />
    <div class="row">
        <div class="col-lg-4">
            <dl class="dl-horizontal">
                <dt>
                    Description
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.ShortDescription)
                </dd>

                <dt>
                    User Id
                </dt>

                <dd>

                    @Html.DisplayFor(model => model.UserId)
                </dd>

                <dt>
                    User Name
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.UserName)
                </dd>

                <dt>
                    Location
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.Location)
                </dd>

                <dt>
                    Area
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.Area)
                </dd>

                <dt>
                    Masjid Id
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.MasjidId)
                </dd>

                <dt>
                    Construction Cost
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.ConstructionCost)
                </dd>

                <dt>
                    Existing Floors
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.ExistingFloors)
                </dd>

                <dt>
                    Amount Needed
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.AmountNeeded)
                </dd>

                <dt>
                    Engineer
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.Engineer)
                </dd>
                <dt>
                    RequestSubmit Id
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.RequestSubmitId, new { @class = "RequestSubmitId" })
                </dd>

                @*<dt>
                        @Html.DisplayNameFor(model => model.Status)
                    </dt>

                    <dd>
                        @Html.DisplayFor(model => model.Status)
                    </dd>*@

                <dt>
                    Created Date
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.CreatedDate)
                </dd>

                <dt>
                    RequestType Id
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.RequestTypeId)
                </dd>

                <dt>
                    Masjid Name
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.MasjidName)
                </dd>

                <dt>
                    RequestType Name
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.RequestTypeName)
                    <br />
                    <br />
                </dd>

                <dt>
                    Elevation
                </dt>

                <dd>
                    @{
                        string base64Elev = string.Empty;
                        string ElevImg = string.Empty;
                        if (Model.Elevation != null)
                        {
                            base64Elev = Convert.ToBase64String(Model.Elevation);
                            ElevImg = string.Format("data:image/jpg;base64,{0}", base64Elev);
                        }

                    }

                    <div class="row">
                        <div class="col-md-4">
                            <div class="thumbnail">
                                <a href='@ElevImg'>
                                    <img src='@ElevImg' alt="Lights" style="width:100%">

                                </a>
                            </div>
                        </div>
                    </div>
                </dd>

                <dt>
                    Plan
                </dt>

                <dd>

                    @{
                        string baseplan = string.Empty;
                        string PlanImg = string.Empty;
                        if (Model.Paln != null)
                        {
                            baseplan = Convert.ToBase64String(Model.Paln);
                            PlanImg = string.Format("data:image/jpg;base64,{0}", baseplan);
                        }

                    }

                    <div class="row">
                        <div class="col-md-4">
                            <div class="thumbnail">
                                <a href='@PlanImg'>
                                    <img src='@PlanImg' alt="Lights" style="width:100%">

                                </a>
                            </div>
                        </div>
                    </div>
                </dd>

                <dt>
                    Doc1
                </dt>

                <dd>

                    @{
                        string baseDoc1 = string.Empty;
                        string Doc1Img = string.Empty;
                        if (Model.Doc1 != null)
                        {
                            baseDoc1 = Convert.ToBase64String(Model.Doc1);
                            Doc1Img = string.Format("data:image/jpg;base64,{0}", baseDoc1);
                        }

                    }

                    <div class="row">
                        <div class="col-md-4">
                            <div class="thumbnail">
                                <a href='@Doc1Img'>
                                    <img src='@Doc1Img' alt="Lights" style="width:100%">

                                </a>
                            </div>
                        </div>
                    </div>
                </dd>


                <dt>
                    Doc2
                </dt>

                <dd>

                    @{
                        string baseDoc2 = string.Empty;
                        string Doc2Img = string.Empty;
                        if (Model.Doc2 != null)
                        {
                            baseDoc2 = Convert.ToBase64String(Model.Doc2);
                            Doc2Img = string.Format("data:image/jpg;base64,{0}", baseDoc2);
                        }

                    }

                    <div class="row">
                        <div class="col-md-4">
                            <div class="thumbnail">
                                <a href='@Doc2Img'>
                                    <img src='@Doc2Img' alt="Lights" style="width:100%">

                                </a>
                            </div>
                        </div>
                    </div>
                </dd>


                <dt>
                    Doc3
                </dt>

                <dd>

                    @{
                        string baseDoc3 = string.Empty;
                        string Doc3Img = string.Empty;
                        if (Model.Doc3 != null)
                        {
                            baseDoc3 = Convert.ToBase64String(Model.Doc3);
                            Doc3Img = string.Format("data:image/jpg;base64,{0}", baseDoc3);
                        }

                    }

                    <div class="row">
                        <div class="col-md-4">
                            <div class="thumbnail">
                                <a href='@Doc3Img'>
                                    <img src='@Doc3Img' alt="Lights" style="width:100%">

                                </a>
                            </div>
                        </div>
                    </div>
                </dd>

                <dt>
                    <strong>Pic1</strong>
                </dt>

                <dd>
                    @{
                        string basePic1 = string.Empty;
                        string Pic1Img = string.Empty;
                        if (Model.Pic1 != null)
                        {
                            basePic1 = Convert.ToBase64String(Model.Pic1);
                            Pic1Img = string.Format("data:image/jpg;base64,{0}", basePic1);

                        }


                    }

                    <div class="row">
                        <div class="col-md-4">
                            <div class="thumbnail">
                                <a href='@Pic1Img'>
                                    <img src='@Pic1Img' alt="Lights" style="width:100%">

                                </a>
                            </div>
                        </div>
                    </div>
                </dd>

                <dt>
                    Pic2
                </dt>

                <dd>
                    @{
                        string basePic2 = string.Empty;
                        string Pic2Img = string.Empty;
                        if (Model.Pic2 != null)
                        {
                            basePic2 = Convert.ToBase64String(Model.Pic2);
                            Pic2Img = string.Format("data:image/jpg;base64,{0}", basePic2);
                        }

                    }

                    <div class="row">
                        <div class="col-md-4">
                            <div class="thumbnail">
                                <a href='@Pic2Img'>
                                    <img src='@Pic2Img' alt="Lights" style="width:100%">

                                </a>
                            </div>
                        </div>
                    </div>
                </dd>

                <dt>
                    Pic3
                </dt>

                <dd>
                    @{
                        string basePic3 = string.Empty;
                        string Pic3Img = string.Empty;
                        if (Model.Pic3 != null)
                        {
                            basePic3 = Convert.ToBase64String(Model.Pic3);
                            Pic3Img = string.Format("data:image/jpg;base64,{0}", basePic3);
                        }

                    }

                    <div class="row">
                        <div class="col-md-4">
                            <div class="thumbnail">
                                <a href='@Pic3Img'>
                                    <img src='@Pic3Img' alt="Lights" style="width:100%">

                                </a>
                            </div>
                        </div>
                    </div>
                </dd>



            </dl>
        </div>

        <div class="col-lg-8">
            <div class="nav-tabs-custom">
                <ul class="nav nav-tabs">
                    <li class="active"><a href="#tab_1" data-toggle="tab" aria-expanded="true">Involve Panel</a></li>
                    <li class=""><a href="#tab_2" data-toggle="tab" aria-expanded="false">Involved Panels </a></li>
                    <li class=""><a href="#tab_3" data-toggle="tab" aria-expanded="false">Member Opinion</a></li>
                    <li class=""><a href="#tab_4" data-toggle="tab" aria-expanded="false">Board Comments</a></li>


                </ul>
                <div class="tab-content">
                    <div class="tab-pane active" id="tab_1">
                        @using (Html.BeginForm("Involve", "InvolveMember", FormMethod.Post))
            {

                            <input type="hidden" value="@Model.RequestTypeId" name="RequestTypeId" />
                            <input type="hidden" value="@Model.RequestSubmitId" name="RequestSubmitId" />
                            <table class="table table-bordered">
                                <tr>
                                    <td><b>Involve Panel</b> </td>
                                </tr>
                                <tbody>
                                    <tr>
                                        <td><input type="checkbox" value="6" name="Involve" />Ulema</td>
                                    </tr>
                                    <tr>
                                        <td><input type="checkbox" value="7" name="Involve" />Finance</td>
                                    </tr>
                                    <tr>
                                        <td><input type="checkbox" value="8" name="Involve" />Legal</td>
                                    </tr>
                                    <tr>
                                        <td><input type="checkbox" value="12" name="Involve" />Advisory</td>
                                    </tr>


                                </tbody>
                                <tfoot>

                                    <tr>
                                        <td><button type="submit" class="btn btn-primary">Involve</button></td>
                                    </tr>

                                </tfoot>

                            </table>

                        }

                    </div>
                    <!-- /.tab-pane -->
                    <div class="tab-pane" id="tab_2">

                        <table class="table table-bordered table-hover">
                            <thead>
                                <tr>
                                    <td>Involved Pannels</td>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var item in Model.PannelMemberInvolved)
                                {
                                    <tr><td>@item.UserTypeName</td></tr>

                                }
                            </tbody>
                        </table>
                    </div>
                    <!-- /.tab-pane -->
                    <div class="tab-pane" id="tab_3">
                        <table class="table table-bordered">

                            <thead>
                                <tr>
                                    <td><b>Member</b></td>
                                    <td><b>UserType</b>
                                    <td><b>Status</b></td>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var item in Model.ApprovedList)
            {
                                    <tr>

                                        <td> @item.UserName</td>
                                        <td> @item.UserTypeName</td>

                                        @if (item.IsApproved == true)
                                        {
                                            <td>

                                                <img src="~/Assets/Img/th3MHOFP7G.jpg" height="30" width="30" />
                                            </td>
                                        }
                                        else
                                        {
                                            <td>

                                                <img src="~/Assets/Img/No.png" height="30" width="30" />
                                            </td>
                                        }


                                    </tr>

                                }
                            </tbody>
                        </table>
                    </div>

                    <div class="tab-pane" id="tab_4">
                        <table class="table table-hover table-condensed">
                            <thead>
                                <tr>
                                    <td><b>Comments</b></td>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var item in Model.BoardCommentList)
                                {
                                    <tr>
                                        <td>
                                            @item.Comment
                                            <b><br />@item.UserName ,@item.UserTypeName</b><br />@item.CreatedDate
                                        </td>
                                    </tr>
                                }

                            </tbody>
                        </table>
                    </div>

                    <div class="tab-pane" id="tab_5">
                        Lorem Ipsum is simply dummy text of the printing and typesetting industry.
                        Lorem Ipsum has been the industry's standard dummy text ever since the 1500s,
                        when an unknown printer took a galley of type and scrambled it to make a type specimen book.
                        It has survived not only five centuries, but also the leap into electronic typesetting,
                        remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset
                        sheets containing Lorem Ipsum passages, and more recently with desktop publishing software
                        like Aldus PageMaker including versions of Lorem Ipsum.
                    </div>
                    <!-- /.tab-pane -->
                </div>
                <!-- /.tab-content -->
            </div>

            <div class="row">
                <div class="col-md-4">
                    <tr>
                        <td>

                            <button class="btn btn-default btn-lg" type="button" id="btnAcceptRequest">

                                Agree
                            </button>
                            <button class="btn btn-default btn-lg" type="button" id="btnAcceptReject">
                                Disagree
                            </button>

                    </tr>
                </div>
                <div class="col-md-8">
                    <div class="form-group">
                        <label>Comment</label>
                        <textarea class="form-control" id="txtComment"></textarea>
                        <br />
                        <button type="button" id="btnPostComment" class="btn  btn-primary">Post Comment</button>
                    </div>
                </div>


            </div>
        </div>
        <div class="col-lg-3">
        </div>
    </div>
</div>
@using (Html.BeginForm())
{
    <input type="hidden" value="@Model.UserId" name="@Model.UserId" id="txtUserId" />
    <input type="hidden" value="@Model.RequestSubmitId" name="@Model.RequestSubmitId" id="txtRequestSubmitId" />
    <input type="hidden" value="@Model.RequestTypeId" name="@Model.RequestTypeId" id="txtRequestTypeId" />
}

<script src="~/Scripts/jquery-1.10.2.min.js"></script>
<script>
    $(document).ready(function () {
        $(document).on("click", "#btnAcceptRequest", function (e) {
            var _registrationModel = {
                UserId: $("#txtUserId").val(),
                RequestSubmitId: $("#txtRequestSubmitId").val(),
                Comment: $("#txtComment").val(),
                Status: true

            };
            buttonDisabledReg();
            $.ajax({
                url: "http://localhost:4101/BoardMember/RequestApprove/ApproveMasjidConstruction",
                type: "POST",
                data: _registrationModel,
                success: function (response) {
                    //  $("#listCategory").empty().append(response);
                    buttonEnableReg();
                },
                error: function (err) {
                    toastr.error("Registration failed: Internal server error");
                    buttonEnableReg();
                    console.log(err);
                }
            });
        });

        $(document).on("click", "#btnAcceptReject", function (e) {
            var _registrationModel = {
                UserId: $("#txtUserId").val(),
                RequestSubmitId: $("#txtRequestSubmitId").val(),
                Comment: $("#txtComment").val(),
                Status: false

            };
            buttonDisabledReg();
            $.ajax({
                url: "http://localhost:4101/BoardMember/RequestApprove/ApproveMasjidConstruction",
                type: "POST",
                data: _registrationModel,
                success: function (response) {
                    //  $("#listCategory").empty().append(response);
                    buttonEnableReg();
                },
                error: function (err) {
                    toastr.error("Registration failed: Internal server error");
                    buttonEnableReg();
                    console.log(err);
                }
            });
        });
        $(document).on("click", "#btnPostComment", function (e) {
            var _registrationModel = {
                UserId: $("#txtUserId").val(),
                RequestSubmitId: $("#txtRequestSubmitId").val(),
                Comment: $("#txtComment").val(),

            };
            buttonDisabledReg();
            $.ajax({
                url: "http://localhost:4101/BoardMember/RequestComment/CommentOnMasjidConstruction",
                type: "POST",
                data: _registrationModel,
                success: function (response) {
                    //  $("#listCategory").empty().append(response);
                    buttonEnableReg();
                    location.reload();


                },
                error: function (err) {
                    toastr.error("Registration failed: Internal server error");
                    buttonEnableReg();
                    console.log(err);
                }
            });
        });
    });

    function buttonEnableReg() {
        $("#btnAcceptRequest span,#btnAcceptReject span").hide();
        $("#btnAcceptRequest,#btnAcceptReject").prop("disabled", false);
    }


    function buttonDisabledReg() {
        $("#btnAcceptRequest span,#btnAcceptReject span").show();
        $("#btnAcceptRequest,#btnAcceptReject").prop("disabled", true);
    }

</script>